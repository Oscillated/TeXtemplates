% +--------------------------------------------------+
% | 2016 ACEE enrollment application form            |
% | Template by weiya, <2215235182@qq.com>           |
% +--------------------------------------------------+
%
% Copyright (c) 2016-2017 by weiya(14ACEEer).
% All Rights Reserved.
%
\NeedsTeXFormat{LaTeX2e}[1995/12/01]
\ProvidesPackage{ACEEenrollment}[2016/03/01 v1.0 ACEE enrollment application form]
\typeout{2016 ACEE Enrollment Application Form}

% packages
\RequirePackage{xeCJK} 
\RequirePackage{xcolor} 
\RequirePackage{fancyhdr,fancybox}       % personalize page header
\RequirePackage{graphicx}       % include graphics
\RequirePackage{ifthen}         % logic options
\RequirePackage{lastpage}       % refer to the number of last page
\RequirePackage{listings}       % format source code
\RequirePackage{titlesec,titletoc}
\RequirePackage{paralist}

\RequirePackage{amsthm,amsfonts}
\RequirePackage{amsmath,bm}              % AMSLaTeX
\RequirePackage{amssymb,mathrsfs}        % AMSLaTeX sym-bols
\RequirePackage{latexsym}
 
\RequirePackage{longtable,multirow,hhline,tabularx,array}  
\RequirePackage{flafter}
\RequirePackage{pifont,calc}
\RequirePackage{colortbl,booktabs}


\RequirePackage{enumitem}
\RequirePackage{float}
\RequirePackage{relsize}

\let\olditemize\itemize
\let\endolditemize\enditemize
\renewenvironment{itemize}{%
    \@nameuse{fontitem\romannumeral\the\@itemdepth}
    \olditemize
}{%
    \endolditemize
}

\newcommand{\fontitem}{\Large}
\newcommand{\fontitemi}{\normalsize}
\newcommand{\fontitemii}{\small}


% fonts
\setCJKfamilyfont{zhhei}{Adobe Heiti Std}
\setCJKfamilyfont{zhli}{LiSu}
\setCJKfamilyfont{zhyou}{YouYuan}
\setCJKfamilyfont{xingkai}{STXINGKA.TTF}
\setCJKfamilyfont{qianming}{MATURASC.TTF}
\setCJKfamilyfont{fang}{STFANGSO.TTF}
\setCJKfamilyfont{KAI}{STKAITI.TTF}
\setCJKfamilyfont{XINWEI}{STXINWEI.TTF}

\newcommand*{\heiti}{\CJKfamily{zhhei}}  
\newcommand*{\lishu}{\CJKfamily{zhli}}   
\newcommand*{\youyuan}{\CJKfamily{zhyou}}
\newcommand*{\xingkai}{\CJKfamily{xingkai}}
\newcommand*{\qianming}{\CJKfamily{qianming}}
\newcommand*{\kaishu}{\CJKfamily{KAI}}
\newcommand*{\xinwei}{\CJKfamily{XINWEI}}
\newcommand*{\fang}{\CJKfamily{fang}}

\setCJKmainfont[BoldFont=Adobe Heiti Std]{YouYuan}
\setmainfont{Times New Roman}


% font size
\newcommand{\verylarge}{\fontsize{60pt}{\baselineskip}\selectfont}  
\newcommand{\chuhao}{\fontsize{44.9pt}{\baselineskip}\selectfont}  
\newcommand{\xiaochu}{\fontsize{38.5pt}{\baselineskip}\selectfont}  
\newcommand{\yihao}{\fontsize{27.8pt}{\baselineskip}\selectfont}  
\newcommand{\xiaoyi}{\fontsize{25.7pt}{\baselineskip}\selectfont}  
\newcommand{\erhao}{\fontsize{23.5pt}{\baselineskip}\selectfont}  
\newcommand{\xiaoerhao}{\fontsize{19.3pt}{\baselineskip}\selectfont} 
\newcommand{\sihao}{\fontsize{14pt}{\baselineskip}\selectfont}     
\newcommand{\xiaosihao}{\fontsize{12pt}{\baselineskip}\selectfont} 
\newcommand{\wuhao}{\fontsize{10.5pt}{\baselineskip}\selectfont}   
\newcommand{\xiaowuhao}{\fontsize{9pt}{\baselineskip}\selectfont}  
\newcommand{\liuhao}{\fontsize{7.875pt}{\baselineskip}\selectfont} 
\newcommand{\qihao}{\fontsize{5.25pt}{\baselineskip}\selectfont}   

% contents
\setcounter{tocdepth}{4}
\setcounter{secnumdepth}{4}

\contentsmargin{0pt}
\titlecontents{section}[1.8pc]
  {\addvspace{3pt}\bfseries}
  {\contentslabel[$\blacklozenge$]{1.8pc}}
  {}
  {\titlerule*[1pc]{.}\thecontentspage}

\titlecontents{subsection}[3.8pc]
  {\small}
  {\contentslabel[$\bigstar$]{1.8pc} }
  {}
  {\titlerule*[1pc]{.} \thecontentspage}
  
\titlecontents{subsubsection}[5.8pc]
  {\small}
  {\contentslabel[$\blacktriangle$]{1.8pc} }
  {}
  {\titlerule*[1pc]{.} \thecontentspage}


% title
\titleformat{\section}{\centering\xinwei\yihao}{}{}{}
\titleformat{\subsection}{\centering\xinwei\xiaoyi}{}{}{}
\titleformat{\subsubsection}{\xinwei\xiaosihao\bf}{}{}{}
            
\newcommand{\ACEEsection}[1]{%
	\par\refstepcounter{section}% Increase section counter
	\sectionmark{#1}% Add section mark (header)
        \section*{#1}
	\addcontentsline{toc}{section}{\protect\numberline{\thesection}#1}% Add section to ToC
}
\newcommand{\ACEEsubsection}[1]{%
	\par\refstepcounter{subsection}% Increase subsection counter
	\subsectionmark{#1}% Add subsection mark (header)
        \subsection*{#1}
	\addcontentsline{toc}{subsection}{\protect\numberline{\thesubsection}#1}% Add subsection to ToC
}
\newcommand{\ACEEsubsubsection}[1]{%
	\par\refstepcounter{subsubsection}% Increase subsubsection counter
	\subsubsectionmark{#1}% Add subsubsection mark (header)
        \subsubsection*{#1}
	\addcontentsline{toc}{subsubsection}{\protect\numberline{\thesubsubsection}#1}% Add subsubsection to ToC
        \noindent\rule{\textwidth}{1.6pt}\vspace*{-\baselineskip}\vspace*{2pt}\\[0.2\baselineskip]
}

% pagestyle
\pagestyle{fancy}
\fancyhf{}
\definecolor{headred}{rgb}{1.0,0,0}
\chead{{\color{headred}A}dvanced Honor {\color{headred}{C}}lass of {\color{headred}{E}}ngineering {\color{headred}{E}}ducation}
\cfoot{{\lishu 工程教育高级班}}
\rfoot{\thepage/\pageref{LastPage}}

\newcommand{\ACEEtitle}[1]{%
	\begingroup 
		\begin{center}
		{\chuhao\xingkai {浙江大学 \\[0.3\baselineskip] 工程教育高级班}}\\[0.2\baselineskip]
		\includegraphics[width=\textwidth]{acee.jpg}
		\vspace*{2\baselineskip}
		{\LARGE\heiti-#1招生资料册-}\par
		\vspace*{1\baselineskip}
		{\LARGE\heiti #1.03}
		\end{center}
		\vfill
	\endgroup
}


\newenvironment{ACEEsubmit}[1]
               {
%	         \begingroup 
		 \begin{center}
		   \rule{0.5\textwidth}{1.6pt}\vspace*{-\baselineskip}\vspace*{2pt} 
		   \rule{0.5\textwidth}{0.4pt}\\[\baselineskip]
		        {\kaishu{\erhao 提交内容}}\\[0.2\baselineskip] 	
		        \rule{0.5\textwidth}{0.4pt}\vspace*{-\baselineskip}\vspace{3.2pt} 
		        \rule{0.5\textwidth}{1.6pt}\\[\baselineskip]
		 \end{center}
	         
                 \par
                 \noindent\rule{\textwidth}{1.6pt}\vspace*{-\baselineskip}\vspace*{2pt}\\[0.2\baselineskip]
 %                \endgroup
                 \def\submitNO{#1}
                 \leavevmode
                 \let\originallabelitemi\labelitemi
	         \renewcommand{\labelitemi}{\LARGE$\blacksquare$}
               }
               {
                 \renewcommand{\labelitemi}{\originallabelitemi}
                 \par
                 \noindent\rule{\textwidth}{1.6pt}\\[0.5\baselineskip]\indent
                 \heiti 请将任务报告填写至报名表的相应区域。除任务报告外，请将其他文件保存至一个文件夹，命名为``学号\_姓名\_\submitNO''
               }

\newenvironment{ACEEproblem}[3]
               {
                 \leavevmode
                 \let\originallabelitemi\labelitemi
	         \renewcommand{\labelitemi}{\yihao$\bullet$}
                 \begin{spacing}{#1}
                   #2#3
               }
               {
                 \end{spacing}
                 \renewcommand{\labelitemi}{\originallabelitemi}
               }


\newenvironment{ACEEmodule}[3]
               {
                 \vspace*{2pt}
                 \noindent\rule{\textwidth}{1.6pt}\vspace*{-\baselineskip}\vspace*{2pt}\\[0.2\baselineskip]
		 \par
                 \begin{spacing}{#1}
                   #2#3
               }
               {
                 \end{spacing}
                 \noindent\rule{\textwidth}{1.6pt}\\[\baselineskip]
               }
    
\newenvironment{ACEEquestion}[3]
               {
                 \vspace*{2pt}
                 \noindent\rule{\textwidth}{1.6pt}\vspace*{-\baselineskip}\vspace*{2pt}\\[0.2\baselineskip]
		 \par
                 \begin{spacing}{#1}
                   #2#3
               }
               {
                 \end{spacing}
               }
               
               
